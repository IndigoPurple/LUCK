The code is a bit messy right now, and I am tidying it up.
